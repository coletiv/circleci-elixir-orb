# TODO: Split this into another orb (elixir-deploy) ?
# The following two commands are specific to edeliver deploy. Should be in another orb ?
description: ""
parameters:
  branch:
    type: string
    description: "String key to store cache in"
    default: "v1"
  config_file_path:
    type: string
    description: "eDeliver configuration file"
steps:
  # This should never use default .deliver/config
  - run: cp << parameters.config_file_path >> .deliver/config
  # - run: mix edeliver build release --branch=<< parameters.branch >>
  # - run: mix edeliver deploy release --start-deploy --branch=<< parameters.branch >>
  # - run: mix edeliver migrate --branch=<< parameters.branch >>
  - run: mix edeliver update production --branch=develop --start-deploy --run-migrations
